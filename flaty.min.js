((function(){var a,b,c,d,e,f,g,h,i,j=Object.prototype.hasOwnProperty;h=function(a){var b,c;return b={},c=function(a,d){var e,f,g,h,i,k,l,m;if(Array.isArray(d)){e=a[a.length-1];for(f=0,l=d.length;f<l;f++)k=d[f],a[a.length-1]=e+"@"+f,c(a,k);return a[a.length-1]=e}if(typeof d=="object"){m=[];for(g in d){if(!j.call(d,g))continue;i=d[g],a.push(g),c(a,i),m.push(a.pop())}return m}return h=a.join("."),b[h]=d},c([],a),b},a="A",b="I",d="P",c="O",e="S",i=function(f){var g,h,i,j,k,l,m;i=[],j=function(c,e){if(i.length&&i[i.length-1][2]===a)return c===""?[b,null,e]:[b,parseInt(c),e];if(c==="")throw"Object property missing key.";return[d,c,e]},g="",m=f.split("");for(k=0,l=m.length;k<l;k++)h=m[k],h==="."?(i.push(j(g,c)),g=""):h==="@"?(i.push(j(g,a)),g=""):g+=h;return i.push(j(g,e)),i},g=function(d){var f,g,h,k,l,m,n,o,p,q,r,s,t,u,v;if(!Array.isArray(d)){h=[];for(m in d){if(!j.call(d,m))continue;p=d[m],h.push([m,p])}}else h=d;g={};for(q=0,s=h.length;q<s;q++){u=h[q],m=u[0],p=u[1],o=i(m),n=g;for(r=0,t=o.length;r<t;r++)v=o[r],l=v[0],k=v[1],f=v[2],f===e?l===b&&k===null?n.push(p):n[k]=p:f===a?l===b&&k===null?(n.push([]),n=n[n.length-1]):(n[k]||(n[k]=[]),n=n[k]):f===c&&(l===b&&k===null?(n.push({}),n=n[n.length-1]):(n[k]||(n[k]={}),n=n[k]))}return g},f=f!=null?f:this,f.flaty={flatten:h,fatten:g}})).call(this);