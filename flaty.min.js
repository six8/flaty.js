(function(){var e,t,n,r,i,s,o,u,a,f={}.hasOwnProperty;u=function(e){var t,n;return t={},n=function(e,r){var i,s,o,u,a,l,c,h,p;if(Array.isArray(r)){i=e[e.length-1];for(s=c=0,h=r.length;c<h;s=++c)l=r[s],e[e.length-1]=i+"@"+s,n(e,l);return e[e.length-1]=i}if(typeof r=="object"){p=[];for(o in r){if(!f.call(r,o))continue;a=r[o],e.push(o),n(e,a),p.push(e.pop())}return p}return u=e.join("."),t[u]=r},n([],e),t},e="A",t="I",r="P",n="O",i="S",a=function(s){var o,u,a,f,l,c,h;a=[],f=function(n,i){if(a.length&&a[a.length-1][2]===e)return n===""?[t,null,i]:[t,parseInt(n,10),i];if(n==="")throw"Object property missing key.";return[r,n,i]},o="",h=s.split("");for(l=0,c=h.length;l<c;l++)u=h[l],u==="."?(a.push(f(o,n)),o=""):u==="@"?(a.push(f(o,e)),o=""):o+=u;return a.push(f(o,i)),a},o=function(r){var s,o,u,l,c,h,p,d,v,m,g,y,b,w,E;if(!Array.isArray(r)){u=[];for(h in r){if(!f.call(r,h))continue;v=r[h],u.push([h,v])}}else u=r;o={};for(m=0,y=u.length;m<y;m++){w=u[m],h=w[0],v=w[1],d=a(h),p=o;for(g=0,b=d.length;g<b;g++)E=d[g],c=E[0],l=E[1],s=E[2],s===i?c===t&&l===null?p.push(v):p[l]=v:s===e?c===t&&l===null?(p.push([]),p=p[p.length-1]):(p[l]||(p[l]=[]),p=p[l]):s===n&&(c===t&&l===null?(p.push({}),p=p[p.length-1]):(p[l]||(p[l]={}),p=p[l]))}return o},s=s!=null?s:this,s.flaty={flatten:u,fatten:o}}).call(this)